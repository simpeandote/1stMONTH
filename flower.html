<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>A Letter for the love of my life.</title>
<link href="https://fonts.googleapis.com/css2?family=Courier+Prime&display=swap" rel="stylesheet">
<style>
  :root{
    --paper-width: 80%;
    --paper-max: 720px;
    --paper-bg-top: #fefcf5;
    --paper-bg-bottom: #f3e9d2;
    --ink: #3a2f25;
    --frame: #bfae94;
    --title-size: 32px;
  }
  html,body{
    height:100%;
    margin:0;
    font-family: 'Courier Prime', monospace;
    background-color: #dcd2c0;
  }

  .stage{
    min-height:100vh;
    display:flex;
    align-items:center;
    justify-content:center;
    padding: 16px;
    box-sizing:border-box;
    overflow:hidden;
  }

  #paper {
    width: var(--paper-width);
    max-width: var(--paper-max);
    min-height: 30vh;
    max-height: 45vh;
    height: auto;
    background: linear-gradient(to bottom, var(--paper-bg-top), var(--paper-bg-bottom));
    padding: 28px 34px;
    border: 4px solid var(--frame);
    border-radius: 12px;
    box-shadow: 8px 10px 30px rgba(0,0,0,0.35);
    position: relative;
    box-sizing: border-box;
    display: flex;
    flex-direction: column;
    overflow-y: auto; /* ¡Corregido! Ahora el scroll está en el contenedor de la carta */
  }

  #paper::before,
  #paper::after {
    content: "";
    position: absolute;
    left: 8px;
    width: calc(100% - 16px);
    height: 8px;
    background: repeating-linear-gradient(
      45deg,
      rgba(0,0,0,0.04),
      rgba(0,0,0,0.04) 2px,
      transparent 2px,
      transparent 4px
    );
    pointer-events:none;
    border-radius:6px;
  }
  #paper::before { top: 8px; }
  #paper::after { bottom: 8px; }

  #title {
    font-size: var(--title-size);
    color: var(--ink);
    text-align: center;
    margin: 0 0 12px 0;
    white-space: nowrap;
    overflow: hidden;
  }

  #letter {
    flex:1;
    font-size: 15px;
    color: var(--ink);
    line-height: 1.6;
    white-space: pre-wrap;
    word-break: break-word;
    padding-right: 8px;
    /* Eliminamos el overflow-y de aquí */
  }

  #letter::-webkit-scrollbar {
    width: 8px;
  }
  #letter::-webkit-scrollbar-thumb {
    background: #c2b5a5;
    border-radius: 6px;
  }
  #letter::-webkit-scrollbar-track {
    background: transparent;
  }

  .cursor {
    display: inline-block;
    width: 2px;
    height: 1em;
    background: var(--ink);
    vertical-align: bottom;
    margin-left: 2px;
    animation: blink 0.7s steps(1) infinite;
  }
  @keyframes blink {
    0%,50%,100% { opacity:1; }
    25%,75% { opacity:0; }
  }
  .cursor.hidden { animation: none; opacity: 0; width: 0; margin:0; }

  @media (max-width:480px){
    #title {
      font-size: 22px;
      white-space: normal;
    }
    #paper {
      padding: 18px;
    }
    #letter { font-size: 13px; }
  }
</style>
</head>
<body>
<div class="stage" id="stage">
  <div id="paper">
    <h1 id="title"></h1>
    <div id="letter"></div>
  </div>
</div>

<audio id="audio" src="ivana - me piensas, LUEGO EXISTO (Video Oficial) [iGy0xL0NBp8].mp3" preload="auto"></audio>

<script>
const titleText = "Primer mes de muchos más...";
const rawLetter = `Mi princesa de miel,

Buah... creo que ese será mi nuevo pet name favorito.
Bueno, ajá. Hola, mi bebé, amor de mi vida, mi otra mitad. Mi medio mango. Me acabas de mandar a dormir y la verdad es que yo llevo toda la noche preparando algo digno de y para vos. Y no me molesta amanecerme en esto mismo pues vos te merecés todo.
Primero que nada, hoy es un día para festejar(nos). Fue un mes hermoso—aunque ambos sabemos que llevamos más que eso—, y puedo jurarte que me encanta compartir mi vida con vos. Podría explayar en hojas y hojas y hojas lo feliz que me haces y todavía sería insuficiente.
Por ahí, una vez, me dijeron que las acciones hablan mil veces más que las palabras, por lo que mi misión en esta vida se resume a abrirte mi corazón cuantas veces sean necesarias para que entiendas una mínima parte de lo que en realidad me haces sentir porque, ciertamente, soy incapaz de explicarlo con exactitud.
Lo que sí sé decir—exponer, gritar a los cuatro vientos—es que un futuro a tu lado es solo un puchito de todo lo que quiero lograr. Sé que quizás son bromas disfrazadas de comentarios, pero me causa mucha curiosidad lo similares que somos en cosas tan normales y, al mismo tiempo, la discordancia que poseemos con el otro y que ni siquiera es causante de malentendidos o desacuerdos o peleas.
Es por eso que sé que a tu lado encontré un lugar seguro, una casita, unos brazos que me rodean e inmediatamente siento que estoy donde pertenezco. Sé que sentís lo mismo porque no son tus palabras las que me lo dicen, son tus acciones y tus iniciativas y tus ganas de seguir luchando contra el mundo a mi lado. Estoy agradecido de eso.
Estoy agradecido por tu acompañamiento, por tu amor, por tu ser y por cualquiera sea la fuerza que te pido en mi camino porque hoy sé que mi destino es a tu lado.
Mi amor es todo tuyo, así como mi mente, mi alma y mi futuro. Quiero todo con vos y este apenas es un mes—año—de muchos, muchos más.
Te amo, mi princesa de miel.
Feliz primer. Feliz primer semestre de aguantar a este loco enamorado que solo sabe estar a tus pies.

`;

const stage = document.getElementById('stage');
const titleEl = document.getElementById('title');
const letterEl = document.getElementById('letter');
const audio = document.getElementById('audio');

let started = false;

function typewriter(el, text, speed=40) {
  return new Promise((resolve)=>{
    const cursor = document.createElement('span');
    cursor.className='cursor';
    el.appendChild(cursor);
    let i=0;
    function step(){
      if(i<text.length){
        const ch=text.charAt(i);
        const prev=cursor.previousSibling;
        if(prev && prev.nodeType===Node.TEXT_NODE){
          prev.nodeValue+=ch;
        }else{
          el.insertBefore(document.createTextNode(ch),cursor);
        }
        i++;
        
        // ¡Corregido! Ahora desplazamos el contenedor principal de la carta
        const paperEl = document.getElementById('paper');
        paperEl.scrollTop = paperEl.scrollHeight;
        
        setTimeout(step,speed+(ch==='\n'?100:0));
      }else{
        cursor.classList.add('hidden');
        resolve();
      }
    }
    step();
  });
}

async function start(){
  if(started) return;
  started=true;
  try{ audio.volume=0.5; await audio.play(); }catch(e){}
  await typewriter(titleEl,titleText,120);
  await new Promise(r=>setTimeout(r,300));
  await typewriter(letterEl,rawLetter,25);
}

document.addEventListener('DOMContentLoaded', start);

stage.addEventListener('click', function onFirstClick(){
  if(audio.paused){
    audio.play();
  } else {
    audio.pause();
  }
});
</script>
</body>
</html>
